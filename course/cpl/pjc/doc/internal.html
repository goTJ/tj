<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-tw" dir="ltr" lang="zh-tw"><head><title>courses:cpl_internal [FHC Wiki]</title>


  
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">

    <meta name="generator" content="DokuWiki Release 2005-09-22a">
  <link rel="start" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/">
  <link rel="contents" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_internal&amp;do=index" title="">
  <link rel="alternate" type="application/rss+xml" title="Recent Changes" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/feed.php">
  <link rel="alternate" type="application/rss+xml" title="Current Namespace" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/feed.php?mode=list&amp;ns=courses">
  <link rel="alternate" type="text/html" title="Plain HTML" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_internal&amp;do=export_html">
  <link rel="alternate" type="text/plain" title="Wiki Markup" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_internal&amp;do=export_raw">
  <link rel="stylesheet" media="screen" type="text/css" href="internal_files/style.css">
  <meta name="date" content="2006-07-04T14:48:27+0800">
  <meta name="robots" content="noindex,nofollow">
  <script language="javascript" type="text/javascript" charset="utf-8">
    var alertText   = '請輸入想要格式化的文字，\n這會附加到文件的結尾。'
    var notSavedYet = '有尚未儲存的變更將會遺失。\n真的要繼續嗎？'
    var DOKU_BASE   = '/~b92106/wiki/'
  </script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="internal_files/script.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="internal_files/tw-sack.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="internal_files/ajax.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="internal_files/domLib.js"></script>
  <script language="javascript" type="text/javascript" charset="utf-8" src="internal_files/domTT.js"></script>
  <link rel="stylesheet" type="text/css" href="internal_files/style_002.css">

  <link rel="shortcut icon" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/lib/images/favicon.ico">
  <link rel="stylesheet" media="screen" type="text/css" href="internal_files/layout.css">
  <link rel="stylesheet" media="screen" type="text/css" href="internal_files/design.css">

  
  <link rel="stylesheet" media="print" type="text/css" href="internal_files/print.css"><!--[if gte IE 5]>
  <style type="text/css">
    /* that IE 5+ conditional comment makes this only visible in IE 5+ */
    /* IE bugfix for transparent PNGs */
    //DISABLED   img { behavior: url("/~b92106/wiki/lib/scripts/pngbehavior.htc"); }
  </style>
  <![endif]--></head><body zhtongwen="traditional" lang="zh-tw">
<div class="dokuwiki">
  
  <div class="stylehead">

    <div class="header">
      <div class="pagename">
        [[<a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_internal&amp;do=backlink" onclick="return svchk()" onkeypress="return svchk()">courses:cpl_internal</a>]]
      </div>
      <div class="logo">
        <a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=" onclick="return svchk()" onkeypress="return svchk()" name="top" accesskey="h" title="[ALT+H]">FHC Wiki</a>      </div>
    </div>
  
    
    <div class="bar" id="bar_top">
      <div class="bar-left" id="bar_topleft">
        <form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="rev" value="" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="編修本頁" class="button" title="ALT+E" accesskey="e" type="submit"></form>        <form class="button" method="get" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="revisions" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="舊版" class="button" title="ALT+O" accesskey="o" type="submit"></form>      </div>
  
      <div class="bar-right" id="bar_topright">
        <form class="button" method="get" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="recent" type="hidden"><input name="id" value="" type="hidden"><input value="最近更新" class="button" title="ALT+R" accesskey="r" type="submit"></form>        <form action="/~b92106/wiki/doku.php?id=" accept-charset="utf-8" class="search" name="search" onsubmit="return svchk()"><input name="do" value="search" type="hidden"><input id="qsearch_in" accesskey="f" name="id" class="edit" onkeyup="ajax_qsearch.call('qsearch_in','qsearch_out')" type="text"><input value="搜尋" class="button" type="submit"><div id="qsearch_out" class="ajax_qsearch" onclick="this.style.display='none'"></div></form>&nbsp;
      </div>
    </div>

        <div class="breadcrumbs">
      目前的足跡: <span class="bcsep">»</span> <a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_features" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="courses:cpl_features">cpl_features</a> <span class="bcsep">»</span> <a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:compiler" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="courses:compiler">compiler</a> <span class="bcsep">»</span> <a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_language" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="courses:cpl_language">cpl_language</a> <span class="bcsep">»</span> <span class="curid"><a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:cpl_internal" onclick="return svchk()" onkeypress="return svchk()" class="breadcrumbs" title="courses:cpl_internal">cpl_internal</a></span>          </div>
    
  </div>
  
  
  <div class="page">
    <!-- wikipage start -->
    <div class="toc">
<div class="tocheader"> <script type="text/javascript">showTocToggle("+","-")</script><div class="toctoggle"><a href="javascript:toggleToc()" class="toc"><span id="showlink" style="display: none;"><img src="internal_files/arrow_down.gif" alt="+"></span><span id="hidelink"><img src="internal_files/arrow_up.gif" alt="-"></span></a></div>
本頁目錄</div>
<div id="tocinside">
<ul class="toc">
<li class="level1"><span class="li"><a href="#begin" class="toc">Begin</a></span></li>
<li class="level1"><span class="li"><a href="#momery_allocation" class="toc">Momery Allocation</a></span><ul class="toc">
<li class="level2"><span class="li"><a href="#usage_register" class="toc">Usage Register</a></span></li>
<li class="level2"><span class="li"><a href="#global_region" class="toc">Global Region</a></span></li>
<li class="level2"><span class="li"><a href="#activation_record" class="toc">Activation Record</a></span></li>
</ul>
</li>
<li class="level1"><span class="li"><a href="#symbol_table" class="toc">Symbol Table</a></span></li>
<li class="level1"><span class="li"><a href="#general_type" class="toc">General Type</a></span></li>
<li class="level1"><span class="li"><a href="#array" class="toc">Array</a></span></li>
<li class="level1"><span class="li"><a href="#swap" class="toc">SWAP</a></span></li>
<li class="level1"><span class="li"><a href="#end" class="toc">End</a></span></li>
</ul>
</div>
</div>

<a name="begin"></a><h1>Begin</h1>
<div class="level1">

<p>
<a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:compiler" class="wikilink1" title="courses:compiler" onclick="return svchk()" onkeypress="return svchk()">回上頁</a>
</p>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="1-44" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="momery_allocation"></a><h1>Momery Allocation</h1>
<div class="level1">

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="45-76" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="usage_register"></a><h2>Usage Register</h2>
<div class="level2">
<table class="inline">
	<tbody><tr>
		<th> Name </th><th> Usage </th>
	</tr>
	<tr>
		<td> I__0 </td><td> FP </td>
	</tr>
</tbody></table>
<br>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="77-135" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="global_region"></a><h2>Global Region</h2>
<div class="level2">
<table class="inline">
	<tbody><tr>
		<th> Address </th><th> Content </th>
	</tr>
	<tr>
		<td class="rightalign">  0 </td><td> DISPLAY[] </td>
	</tr>
</tbody></table>
<br>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="136-203" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="activation_record"></a><h2>Activation Record</h2>
<div class="level2">
<table class="inline">
	<tbody><tr>
		<th> Address </th><th> Content </th>
	</tr>
	<tr>
		<td class="rightalign">  0 </td><td> Reture value </td>
	</tr>
	<tr>
		<td class="rightalign">  1 </td><td> FP </td>
	</tr>
	<tr>
		<td class="rightalign">  2 </td><td> local variables </td>
	</tr>
	<tr>
		<td class="rightalign">  temp_start </td><td> temp variables </td>
	</tr>
</tbody></table>
<br>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="204-348" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="symbol_table"></a><h1>Symbol Table</h1>
<div class="level1">

<p>
我先宣告一個 virtual class SymbolTable，然後利用繼承的方式來決定 symbol table 實作的方式。 
</p>
<pre class="code cpp">class SymbolTable<span class="br0">{</span>
<span class="kw2">public</span>:
        <span class="kw2">virtual</span> <span class="kw4">void</span> newLayer<span class="br0">(</span><span class="br0">)</span>=<span class="nu0">0</span>;
        <span class="kw2">virtual</span> <span class="kw4">void</span> delLayer<span class="br0">(</span><span class="br0">)</span>=<span class="nu0">0</span>;
        <span class="kw2">virtual</span> <span class="kw4">int</span> getLayerSize<span class="br0">(</span><span class="br0">)</span>=<span class="nu0">0</span>;
        <span class="kw2">virtual</span> <span class="kw4">void</span> addVar<span class="br0">(</span>string, GeneralType<span class="br0">)</span>=<span class="nu0">0</span>;
        <span class="kw2">virtual</span> GeneralType *getVar<span class="br0">(</span>string<span class="br0">)</span>=<span class="nu0">0</span>;
<span class="br0">}</span>;</pre>
</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="349-748" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="general_type"></a><h1>General Type</h1>
<div class="level1">

<p>
由於 type 的型態很多，會造成在 passing 上的困擾，因此我建了一個 structure GeneralType 來達到泛型的目的： 
</p>
<pre class="code cpp"><span class="kw4">struct</span> GeneralType<span class="br0">{</span> <span class="co1">// {{{</span>
        Type t;
        Scope s;
        <span class="kw4">union</span><span class="br0">{</span>
                GeneralType *typeGtp;
                <span class="kw4">struct</span><span class="br0">{</span>
                        <span class="kw4">int</span> offset;
                        <span class="kw4">int</span> oriOffset;
                        <span class="kw4">int</span> size;
                        list&lt;Dimension&gt; *arrayBound;
                        <span class="kw4">int</span> depth;
                        GeneralType *tempGtp;
                <span class="br0">}</span>;
                <span class="kw4">struct</span><span class="br0">{</span>
                        string *pname;
                        list&lt;GeneralType&gt; *arg_list;
                        GeneralType *retVal;
                <span class="br0">}</span>;
                <span class="kw4">int</span> ival;
                <span class="kw4">float</span> fval;
        <span class="br0">}</span>;
<span class="br0">}</span></pre>
</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="749-1578" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="array"></a><h1>Array</h1>
<div class="level1">

<p>
由於 array 有多個 dimension，所以我在 GeneralType 裡開一個 arrayBound 來存每個 dimension
的 lower bound、upper bound、size，並用 size 來存 array 的大小，並用 offset 來存 array
[0,0,...,0] 的 offset，這樣取值時只要，去取每個 index*size 的相加就好了。 </p>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="1579-1903" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="swap"></a><h1>SWAP</h1>
<div class="level1">

<p>
SWAP 可以在 array 及 value 上作用，value 的部分很容易，而針對 array 的部分，由於我們已知 array 的 offset 跟 size，所以我們可以簡單寫一個 while 迴圈來 SWAP 每一個值。
</p>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="1904-2139" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<a name="end"></a><h1>End</h1>
<div class="level1">

<p>
<a href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/doku.php?id=courses:compiler" class="wikilink1" title="courses:compiler" onclick="return svchk()" onkeypress="return svchk()">回上頁</a> 
</p>

</div>
<div class="secedit"><form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="lines" value="2140-" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="改這段" class="button" type="submit"></form></div>
<!-- no cachefile used, but created -->
    <!-- wikipage stop -->
  </div>

  <div class="clearer">&nbsp;</div>

  
  <div class="stylefoot">

    <div class="meta">
      <div class="user">
        登入為: flyhermit      </div>
      <div class="doc">
        courses/cpl_internal.txt · 上一次變更: 2006/07/04 14:48 來自 fhc      </div>
    </div>

   
    <div class="bar" id="bar_bottom">
      <div class="bar-left" id="bar_bottomleft">
        <form class="button" method="post" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="edit" type="hidden"><input name="rev" value="" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="編修本頁" class="button" title="ALT+E" accesskey="e" type="submit"></form>        <form class="button" method="get" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="revisions" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="舊版" class="button" title="ALT+O" accesskey="o" type="submit"></form>      </div>
      <div class="bar-right" id="bar_bottomright">
                <form class="button" method="get" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="admin" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="管理選單" class="button" type="submit"></form>        <form class="button" method="get" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="logout" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="登出" class="button" type="submit"></form>        <form class="button" method="get" action="/~b92106/wiki/doku.php" onsubmit="return svchk()"><input name="do" value="index" type="hidden"><input name="id" value="courses:cpl_internal" type="hidden"><input value="索引頁" class="button" title="ALT+X" accesskey="x" type="submit"></form>        <a href="#top"><input class="button" value="回到頁頂" onclick="window.scrollTo(0, 0)" type="button"></a>&nbsp;
      </div>
    </div>

  </div>

</div>

<div class="footerinc" align="center">
  <a target="_blank" href="http://www.csie.ntu.edu.tw/%7Eb92106/wiki/feed.php" title="Recent changes RSS feed"><img src="internal_files/button-rss.png" alt="Recent changes RSS feed" border="0" height="15" width="80"></a>

  <a target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/2.0/" rel="license" title="Creative Commons License"><img src="internal_files/button-cc.gif" alt="Creative Commons License" border="0" height="15" width="80"></a>

  <a target="_blank" href="https://www.paypal.com/xclick/business=andi%40splitbrain.org&amp;item_name=DokuWiki+Donation&amp;no_shipping=1&amp;no_note=1&amp;tax=0&amp;currency_code=EUR&amp;lc=US" title="Donate"><img src="internal_files/button-donate.gif" alt="Donate" border="0"></a>

  <a target="_blank" href="http://www.php.net/" title="Powered by PHP"><img src="internal_files/button-php.gif" alt="Powered by PHP" border="0" height="15" width="80"></a>

  <a target="_blank" href="http://validator.w3.org/check/referer" title="Valid XHTML 1.0"><img src="internal_files/button-xhtml.png" alt="Valid XHTML 1.0" border="0" height="15" width="80"></a>

  <a target="_blank" href="http://jigsaw.w3.org/css-validator/check/referer" title="Valid CSS"><img src="internal_files/button-css.png" alt="Valid CSS" border="0" height="15" width="80"></a>

  <a target="_blank" href="http://wiki.splitbrain.org/wiki:dokuwiki" title="Driven by DokuWiki"><img src="internal_files/button-dw.png" alt="Driven by DokuWiki" border="0" height="15" width="80"></a>



<!--

<rdf:RDF xmlns="http://web.resource.org/cc/"
    xmlns:dc="http://purl.org/dc/elements/1.1/"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
<Work rdf:about="">
   <dc:type rdf:resource="http://purl.org/dc/dcmitype/Text" />
   <license rdf:resource="http://creativecommons.org/licenses/by-nc-sa/2.0/" />
</Work>

<License rdf:about="http://creativecommons.org/licenses/by-nc-sa/2.0/">
   <permits rdf:resource="http://web.resource.org/cc/Reproduction" />
   <permits rdf:resource="http://web.resource.org/cc/Distribution" />
   <requires rdf:resource="http://web.resource.org/cc/Notice" />
   <requires rdf:resource="http://web.resource.org/cc/Attribution" />
   <prohibits rdf:resource="http://web.resource.org/cc/CommercialUse" />
   <permits rdf:resource="http://web.resource.org/cc/DerivativeWorks" />
   <requires rdf:resource="http://web.resource.org/cc/ShareAlike" />
</License>

</rdf:RDF>

-->
</div>

<img src="internal_files/indexer.gif" alt="" height="1" width="1">
</body></html>